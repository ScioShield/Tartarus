{"actions": [], "author": ["Subhash Popuri (@pbssubhash), Florian Roth (Nextron Systems), Thurein Oo, Nasreddine Bencherchali (Nextron Systems), Dylan Shield (Shieldia.co)"], "description": "Detects path traversal exploitation attempts\n", "enabled": true, "exceptions_list": [], "false_positives": ["Expected to be continuously seen on systems exposed to the Internet", "Internal vulnerability scanners"], "from": "now-9m", "id": "5a06ded0-5111-45c9-a8fd-bd8d6d3ecefc", "immutable": false, "index": ["logs-apache.access-default"], "interval": "5m", "language": "esql", "license": "DRL 1.1", "max_signals": 100, "meta": {"from": "1m"}, "name": "SIGMA - Path Traversal Exploitation Attempts", "note": "", "output_index": "", "query": "from logs-apache.access-default metadata _id, _index, _version | where url.query like \"*../../../../../lib/password*\" or url.query like \"*../../../../windows/*\" or url.query like \"*../../../etc/*\" or url.query like \"*..%252f..%252f..%252fetc%252f*\" or url.query like \"*..%c0%af..%c0%af..%c0%afetc%c0%af*\" or url.query like \"*%252e%252e%252fetc%252f*\"\n| eval timebucket=date_trunc(5minutes, @timestamp) | stats value_count=count_distinct(url.query) by timebucket, source.ip, host.name\n| where value_count \u003e= 1", "references": ["https://github.com/projectdiscovery/nuclei-templates", "https://book.hacktricks.xyz/pentesting-web/file-inclusion"], "related_integrations": [], "required_fields": [], "risk_score": 50, "risk_score_mapping": [], "rule_id": "5a06ded0-5111-45c9-a8fd-bd8d6d3ecefc", "setup": "", "severity": "medium", "severity_mapping": [], "tags": [], "threat": [{"framework": "MITRE ATT\u0026CK", "tactic": {"id": "TA0001", "name": "Initial-Access", "reference": "https://attack.mitre.org/tactics/TA0001"}, "technique": [{"id": "T1190", "name": "Exploit Public-Facing Application", "reference": "https://attack.mitre.org/techniques/T1190", "subtechnique": []}]}], "to": "now", "type": "esql", "version": 1}