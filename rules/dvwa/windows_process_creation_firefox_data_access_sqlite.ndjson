{"id": "c9fd12ee-2cd4-44e0-8909-53b5044ad711", "name": "SIGMA - SQLite Firefox Profile Data DB Access", "enabled": true, "throttle": "no_actions", "interval": "5m", "author": ["Dylan Shield (Shieldia.co)"], "description": "Detect usage of the \"sqlite\" binary to query Firefox databases for potential data stealing.", "rule_id": "c9fd12ee-2cd4-44e0-8909-53b5044ad711", "false_positives": ["Unknown"], "from": "now-5m", "immutable": false, "license": "DRL", "output_index": "", "meta": {"from": "1m"}, "max_signals": 100, "risk_score": 73, "severity": "high", "risk_score_mapping": [], "severity_mapping": [], "threat": [{"tactic": {"id": "TA0006", "reference": "https://attack.mitre.org/tactics/TA0006", "name": "Credential-Access"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1539", "reference": "https://attack.mitre.org/techniques/T1539", "name": "Steal Web Session Cookie", "subtechnique": []}]}, {"tactic": {"id": "TA0009", "reference": "https://attack.mitre.org/tactics/TA0009", "name": "Collection"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1555", "reference": "https://attack.mitre.org/techniques/T1555", "name": "Credentials from Password Stores", "subtechnique": [{"id": "T1555.003", "reference": "https://attack.mitre.org/techniques/T1555/003", "name": "Credentials from Web Browsers"}]}]}], "tags": [], "to": "now", "references": ["https://www.mozilla.org/en-US/firefox/", "https://support.mozilla.org/en-US/kb/profiles-where-firefox-stores-user-data"], "version": 1, "exceptions_list": [], "related_integrations": [], "required_fields": [], "setup": "", "type": "eql", "language": "eql", "index": ["apm-*-transaction*", "auditbeat-*", "endgame-*", "filebeat-*", "logs-*", "packetbeat-*", "traces-apm*", "winlogbeat-*", "-*elastic-cloud-logs-*"], "query": "any where (process.name:\"SQLite\" or (process.executable like~ (\"*\\\\sqlite.exe\", \"*\\\\sqlite3.exe\"))) and (process.command_line like~ (\"*\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\", \"*\\\\AppData\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\")) and (process.command_line like~ (\"*cookies.sqlite*\", \"*places.sqlite*\", \"*formhistory.sqlite*\", \"*webappsstore.sqlite*\"))", "filters": [], "actions": []}
